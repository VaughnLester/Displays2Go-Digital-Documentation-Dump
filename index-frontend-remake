<!DOCTYPE html>
<html>

  <body>

  <h3>New SKU</h3>
  <form id="newSKU" action="/confirmation">
    <label for="newSKU">New SKU:</label><br>
    <input type="text" id="newSKU" name="newSKU"><br>
    <input type="submit" value="Submit">
  </form>
  <h3>Add Entry</h3>
  <form id="addEntry" action="/confirmation">
    <label for="existingSKU">SKU:</label><br>
    <input type="text" id="existingSKU" name="existingSKU"><br>
    <label for="title">Title:</label><br>
    <input type="text" id="title" name="title">
    <label for="entry">Entry:</label><br>
    <input type="text" id="entry" name="entry">
    <input type="submit" value="Submit">
  </form>
     <a href="/allSKUs">SKU Database</a>
  <h3>View SKU</h3>
  <form id="skuPage" action="/skuPage">
    <label for="skuPage">SKU:</label><br>
    <input type="text" id="skuPage" name="skuPage"><br>
    <input type="submit" value="Submit">
  </form>
  <h3>Delete SKU</h3>
  <form id="deleteSKU" action="/confirmation">
    <label for="deleteSKU">SKU:</label><br>
    <input type="text" id="deleteSKU" name="deleteSKU"><br>
    <input type="submit" value="Submit">
  </form>
  <h3>Delete SKU Entry</h3>
  <form id="deleteSkuEntry" action="/confirmation">
    <label for="sku">SKU:</label><br>
    <input type="text" id="sku" name="sku"><br>
    <label for="deleteSkuEntry">Entry:</label><br>
    <input type="text" id="deleteSkuEntry" name="deleteSkuEntry"><br>
    <input type="submit" value="Submit">
  </form>
  <h3>Update SKU Entry</h3>
  <form id="skuUpdateEntry" action="/confirmation">
    <label for="skuNameUpdate">SKU:</label><br>
    <input type="text" id="skuNameUpdate" name="skuNameUpdate"><br>
    <label for="title">Title:</label><br>
    <input type="text" id="title" name="title"><br>
    <label for="entryUpdate">Entry:</label><br>
    <input type="text" id="entryUpdate" name="entryUpdate"><br>
    <input type="submit" value="Submit">
  </form>
  <h3>Change SKU Name</h3>
  <form id="changeSkuName" action="/confirmation">
    <label for="sku">SKU:</label><br>
    <input type="text" id="sku" name="sku"><br>
    <label for="changeSkuName">New SKU Name:</label><br>
    <input type="text" id="changeSkuName" name="changeSkuName"><br>
    <input type="submit" value="Submit">
  </form>

  </body>







  <script>
   const newSKU = document.getElementById('newSKU');  
   newSKU.addEventListener('submit', async (event)=> {
    //event.preventDefault();
    const formData = new FormData(newSKU);
    const response = await fetch ('/newSKU', {  
      method: 'POST', 
      body: new URLSearchParams(formData), 
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    })
   })

   const addEntry = document.getElementById('addEntry');  
   addEntry.addEventListener('submit', async (event)=> {
    //event.preventDefault();
    const formData = new FormData(addEntry);
    const response = await fetch ('/addEntry', {  
      method: 'POST', 
      body: new URLSearchParams(formData), 
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    })
   })

    async function getAllSKUs(){
      try{
        const response = await fetch("/allSKUs");
        if (response.ok){
            const text = await response.text();
            textArray = text.split(",");
            // element.innerHTML = textArray[1];
            //attaching each table name to the dom and adding link
            textArray.forEach( function(table){
                let x = document.createElement('a');
                x.setAttribute('href', `http://localhost:5001/table?name=${table}`);
                x.textContent = table;
                element.appendChild(x);
            })    
        } 
        else{
            throw new Error('Failed to fetch data');
        }
      }
      catch (error){
        console.log('Error:', error);
      }
    }    
   getAllSKUs();

   const skuPage = document.getElementById('skuPage');  
   skuPage.addEventListener('submit', async (event)=> {
    //event.preventDefault();
    const formData = new FormData(skuPage);
    const response = await fetch ('/skuPage', {  
      method: 'GET', 
      body: new URLSearchParams(formData), 
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    })
   })

   const deleteSKU = document.getElementById('deleteSKU');  
   deleteSKU.addEventListener('submit', async (event)=> {
    //event.preventDefault();
    const formData = new FormData(deleteSKU);
    const response = await fetch ('/deleteSKU', {  
      method: 'DELETE', 
      body: new URLSearchParams(formData), 
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    })
   })

   const deleteSkuEntry = document.getElementById('deleteSkuEntry');  
   deleteSkuEntry.addEventListener('submit', async (event)=> {
    //event.preventDefault();
    const formData = new FormData(deleteSkuEntry);
    const response = await fetch ('/deleteSkuEntry', {  
      method: 'DELETE', 
      body: new URLSearchParams(formData), 
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    })
   })

   const skuUpdateEntry = document.getElementById('skuUpdateEntry');  
   skuUpdateEntry.addEventListener('submit', async (event)=> {
    //event.preventDefault();
    const formData = new FormData(skuUpdateEntry);
    const response = await fetch ('/skuUpdateEntry', {  
      method: 'PUT', 
      body: new URLSearchParams(formData), 
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    })
   })

   const changeSkuName = document.getElementById('changeSkuName');  
   changeSkuName.addEventListener('submit', async (event)=> {
    //event.preventDefault();
    const formData = new FormData(changeSkuName);
    const response = await fetch ('/changeSkuName', {  
      method: 'PUT', 
      body: new URLSearchParams(formData), 
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    })
   })

  </script>
</html>